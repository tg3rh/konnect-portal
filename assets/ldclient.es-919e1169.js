function Q(t){function e(i,r){Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor),this.message=i,this.code=r}return e.prototype=new Error,e.prototype.name=t,e.prototype.constructor=e,e}const Ce=Q("LaunchDarklyUnexpectedResponseError"),xe=Q("LaunchDarklyInvalidEnvironmentIdError"),Pe=Q("LaunchDarklyInvalidUserError"),Se=Q("LaunchDarklyInvalidEventKeyError"),Ie=Q("LaunchDarklyInvalidArgumentError"),Oe=Q("LaunchDarklyFlagFetchError");for(var F={LDUnexpectedResponseError:Ce,LDInvalidEnvironmentIdError:xe,LDInvalidUserError:Pe,LDInvalidEventKeyError:Se,LDInvalidArgumentError:Ie,LDInvalidDataError:Q("LaunchDarklyInvalidDataError"),LDFlagFetchError:Oe,isHttpErrorRecoverable:function(t){return!(t>=400&&t<500)||t===400||t===408||t===429}},Le=function(t){var e=Qt(t),i=e[0],r=e[1];return 3*(i+r)/4-r},Ue=function(t){var e,i,r=Qt(t),c=r[0],n=r[1],o=new Re(function(u,l,d){return 3*(l+d)/4-d}(0,c,n)),a=0,s=n>0?c-4:c;for(i=0;i<s;i+=4)e=G[t.charCodeAt(i)]<<18|G[t.charCodeAt(i+1)]<<12|G[t.charCodeAt(i+2)]<<6|G[t.charCodeAt(i+3)],o[a++]=e>>16&255,o[a++]=e>>8&255,o[a++]=255&e;return n===2&&(e=G[t.charCodeAt(i)]<<2|G[t.charCodeAt(i+1)]>>4,o[a++]=255&e),n===1&&(e=G[t.charCodeAt(i)]<<10|G[t.charCodeAt(i+1)]<<4|G[t.charCodeAt(i+2)]>>2,o[a++]=e>>8&255,o[a++]=255&e),o},Te=function(t){for(var e,i=t.length,r=i%3,c=[],n=16383,o=0,a=i-r;o<a;o+=n)c.push(je(t,o,o+n>a?a:o+n));return r===1?(e=t[i-1],c.push(X[e>>2]+X[e<<4&63]+"==")):r===2&&(e=(t[i-2]<<8)+t[i-1],c.push(X[e>>10]+X[e>>4&63]+X[e<<2&63]+"=")),c.join("")},X=[],G=[],Re=typeof Uint8Array<"u"?Uint8Array:Array,Ct="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",nt=0,Ae=Ct.length;nt<Ae;++nt)X[nt]=Ct[nt],G[Ct.charCodeAt(nt)]=nt;function Qt(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var i=t.indexOf("=");return i===-1&&(i=e),[i,i===e?0:4-i%4]}function je(t,e,i){for(var r,c,n=[],o=e;o<i;o+=3)r=(t[o]<<16&16711680)+(t[o+1]<<8&65280)+(255&t[o+2]),n.push(X[(c=r)>>18&63]+X[c>>12&63]+X[c>>6&63]+X[63&c]);return n.join("")}G["-".charCodeAt(0)]=62,G["_".charCodeAt(0)]=63;var Ne={byteLength:Le,toByteArray:Ue,fromByteArray:Te},Zt=Array.isArray,te=Object.keys,Fe=Object.prototype.hasOwnProperty,$e=function t(e,i){if(e===i)return!0;if(e&&i&&typeof e=="object"&&typeof i=="object"){var r,c,n,o=Zt(e),a=Zt(i);if(o&&a){if((c=e.length)!=i.length)return!1;for(r=c;r--!=0;)if(!t(e[r],i[r]))return!1;return!0}if(o!=a)return!1;var s=e instanceof Date,u=i instanceof Date;if(s!=u)return!1;if(s&&u)return e.getTime()==i.getTime();var l=e instanceof RegExp,d=i instanceof RegExp;if(l!=d)return!1;if(l&&d)return e.toString()==i.toString();var g=te(e);if((c=g.length)!==te(i).length)return!1;for(r=c;r--!=0;)if(!Fe.call(i,g[r]))return!1;for(r=c;r--!=0;)if(!t(e[n=g[r]],i[n]))return!1;return!0}return e!=e&&i!=i};const Ve=["key","ip","country","email","firstName","lastName","avatar","name"];function we(t){const e=unescape(encodeURIComponent(t));return Ne.fromByteArray(function(i){const r=[];for(let c=0;c<i.length;c++)r.push(i.charCodeAt(c));return r}(e))}function ee(t){return we(t).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function xt(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var Pt,D={appendUrlPath:function(t,e){return(t.endsWith("/")?t.substring(0,t.length-1):t)+(e.startsWith("/")?"":"/")+e},base64URLEncode:ee,btoa:we,chunkEventsForUrl:function(t,e){const i=e.slice(0),r=[];let c,n=t;for(;i.length>0;){for(c=[];n>0;){const o=i.shift();if(!o)break;n-=ee(JSON.stringify(o)).length,n<0&&c.length>0?i.unshift(o):c.push(o)}n=t,r.push(c)}return r},clone:function(t){return JSON.parse(JSON.stringify(t))},deepEquals:function(t,e){return $e(t,e)},extend:function(...t){return t.reduce((e,i)=>({...e,...i}),{})},getLDUserAgentString:function(t){const e=t.version||"?";return t.userAgent+"/"+e},objectHasOwnProperty:xt,onNextTick:function(t){setTimeout(t,0)},sanitizeContext:function(t){if(!t)return t;let e;return t.kind!==null&&t.kind!==void 0||Ve.forEach(i=>{const r=t[i];r!==void 0&&typeof r!="string"&&(e=e||{...t},e[i]=String(r))}),e||t},transformValuesToVersionedValues:function(t){const e={};for(const i in t)xt(t,i)&&(e[i]={value:t[i],version:0});return e},transformVersionedValuesToValues:function(t){const e={};for(const i in t)xt(t,i)&&(e[i]=t[i].value);return e},wrapPromiseCallback:function(t,e){const i=t.then(r=>(e&&setTimeout(()=>{e(null,r)},0),r),r=>{if(!e)return Promise.reject(r);setTimeout(()=>{e(r,null)},0)});return e?void 0:i}},He=new Uint8Array(16);function ne(){if(!Pt&&!(Pt=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Pt(He)}var qe=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function vt(t){return typeof t=="string"&&qe.test(t)}for(var re,St,H=[],It=0;It<256;++It)H.push((It+256).toString(16).substr(1));function gt(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=(H[t[e+0]]+H[t[e+1]]+H[t[e+2]]+H[t[e+3]]+"-"+H[t[e+4]]+H[t[e+5]]+"-"+H[t[e+6]]+H[t[e+7]]+"-"+H[t[e+8]]+H[t[e+9]]+"-"+H[t[e+10]]+H[t[e+11]]+H[t[e+12]]+H[t[e+13]]+H[t[e+14]]+H[t[e+15]]).toLowerCase();if(!vt(i))throw TypeError("Stringified UUID is invalid");return i}var Ot=0,Lt=0;function be(t){if(!vt(t))throw TypeError("Invalid UUID");var e,i=new Uint8Array(16);return i[0]=(e=parseInt(t.slice(0,8),16))>>>24,i[1]=e>>>16&255,i[2]=e>>>8&255,i[3]=255&e,i[4]=(e=parseInt(t.slice(9,13),16))>>>8,i[5]=255&e,i[6]=(e=parseInt(t.slice(14,18),16))>>>8,i[7]=255&e,i[8]=(e=parseInt(t.slice(19,23),16))>>>8,i[9]=255&e,i[10]=(e=parseInt(t.slice(24,36),16))/1099511627776&255,i[11]=e/4294967296&255,i[12]=e>>>24&255,i[13]=e>>>16&255,i[14]=e>>>8&255,i[15]=255&e,i}function ke(t,e,i){function r(c,n,o,a){if(typeof c=="string"&&(c=function(l){l=unescape(encodeURIComponent(l));for(var d=[],g=0;g<l.length;++g)d.push(l.charCodeAt(g));return d}(c)),typeof n=="string"&&(n=be(n)),n.length!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");var s=new Uint8Array(16+c.length);if(s.set(n),s.set(c,n.length),(s=i(s))[6]=15&s[6]|e,s[8]=63&s[8]|128,o){a=a||0;for(var u=0;u<16;++u)o[a+u]=s[u];return o}return gt(s)}try{r.name=t}catch{}return r.DNS="6ba7b810-9dad-11d1-80b4-00c04fd430c8",r.URL="6ba7b811-9dad-11d1-80b4-00c04fd430c8",r}function oe(t){return 14+(t+64>>>9<<4)+1}function Y(t,e){var i=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(i>>16)<<16|65535&i}function pt(t,e,i,r,c,n){return Y((o=Y(Y(e,t),Y(r,n)))<<(a=c)|o>>>32-a,i);var o,a}function q(t,e,i,r,c,n,o){return pt(e&i|~e&r,t,e,c,n,o)}function M(t,e,i,r,c,n,o){return pt(e&r|i&~r,t,e,c,n,o)}function K(t,e,i,r,c,n,o){return pt(e^i^r,t,e,c,n,o)}function _(t,e,i,r,c,n,o){return pt(i^(e|~r),t,e,c,n,o)}var Me=ke("v3",48,function(t){if(typeof t=="string"){var e=unescape(encodeURIComponent(t));t=new Uint8Array(e.length);for(var i=0;i<e.length;++i)t[i]=e.charCodeAt(i)}return function(r){for(var c=[],n=32*r.length,o="0123456789abcdef",a=0;a<n;a+=8){var s=r[a>>5]>>>a%32&255,u=parseInt(o.charAt(s>>>4&15)+o.charAt(15&s),16);c.push(u)}return c}(function(r,c){r[c>>5]|=128<<c%32,r[oe(c)-1]=c;for(var n=1732584193,o=-271733879,a=-1732584194,s=271733878,u=0;u<r.length;u+=16){var l=n,d=o,g=a,m=s;n=q(n,o,a,s,r[u],7,-680876936),s=q(s,n,o,a,r[u+1],12,-389564586),a=q(a,s,n,o,r[u+2],17,606105819),o=q(o,a,s,n,r[u+3],22,-1044525330),n=q(n,o,a,s,r[u+4],7,-176418897),s=q(s,n,o,a,r[u+5],12,1200080426),a=q(a,s,n,o,r[u+6],17,-1473231341),o=q(o,a,s,n,r[u+7],22,-45705983),n=q(n,o,a,s,r[u+8],7,1770035416),s=q(s,n,o,a,r[u+9],12,-1958414417),a=q(a,s,n,o,r[u+10],17,-42063),o=q(o,a,s,n,r[u+11],22,-1990404162),n=q(n,o,a,s,r[u+12],7,1804603682),s=q(s,n,o,a,r[u+13],12,-40341101),a=q(a,s,n,o,r[u+14],17,-1502002290),n=M(n,o=q(o,a,s,n,r[u+15],22,1236535329),a,s,r[u+1],5,-165796510),s=M(s,n,o,a,r[u+6],9,-1069501632),a=M(a,s,n,o,r[u+11],14,643717713),o=M(o,a,s,n,r[u],20,-373897302),n=M(n,o,a,s,r[u+5],5,-701558691),s=M(s,n,o,a,r[u+10],9,38016083),a=M(a,s,n,o,r[u+15],14,-660478335),o=M(o,a,s,n,r[u+4],20,-405537848),n=M(n,o,a,s,r[u+9],5,568446438),s=M(s,n,o,a,r[u+14],9,-1019803690),a=M(a,s,n,o,r[u+3],14,-187363961),o=M(o,a,s,n,r[u+8],20,1163531501),n=M(n,o,a,s,r[u+13],5,-1444681467),s=M(s,n,o,a,r[u+2],9,-51403784),a=M(a,s,n,o,r[u+7],14,1735328473),n=K(n,o=M(o,a,s,n,r[u+12],20,-1926607734),a,s,r[u+5],4,-378558),s=K(s,n,o,a,r[u+8],11,-2022574463),a=K(a,s,n,o,r[u+11],16,1839030562),o=K(o,a,s,n,r[u+14],23,-35309556),n=K(n,o,a,s,r[u+1],4,-1530992060),s=K(s,n,o,a,r[u+4],11,1272893353),a=K(a,s,n,o,r[u+7],16,-155497632),o=K(o,a,s,n,r[u+10],23,-1094730640),n=K(n,o,a,s,r[u+13],4,681279174),s=K(s,n,o,a,r[u],11,-358537222),a=K(a,s,n,o,r[u+3],16,-722521979),o=K(o,a,s,n,r[u+6],23,76029189),n=K(n,o,a,s,r[u+9],4,-640364487),s=K(s,n,o,a,r[u+12],11,-421815835),a=K(a,s,n,o,r[u+15],16,530742520),n=_(n,o=K(o,a,s,n,r[u+2],23,-995338651),a,s,r[u],6,-198630844),s=_(s,n,o,a,r[u+7],10,1126891415),a=_(a,s,n,o,r[u+14],15,-1416354905),o=_(o,a,s,n,r[u+5],21,-57434055),n=_(n,o,a,s,r[u+12],6,1700485571),s=_(s,n,o,a,r[u+3],10,-1894986606),a=_(a,s,n,o,r[u+10],15,-1051523),o=_(o,a,s,n,r[u+1],21,-2054922799),n=_(n,o,a,s,r[u+8],6,1873313359),s=_(s,n,o,a,r[u+15],10,-30611744),a=_(a,s,n,o,r[u+6],15,-1560198380),o=_(o,a,s,n,r[u+13],21,1309151649),n=_(n,o,a,s,r[u+4],6,-145523070),s=_(s,n,o,a,r[u+11],10,-1120210379),a=_(a,s,n,o,r[u+2],15,718787259),o=_(o,a,s,n,r[u+9],21,-343485551),n=Y(n,l),o=Y(o,d),a=Y(a,g),s=Y(s,m)}return[n,o,a,s]}(function(r){if(r.length===0)return[];for(var c=8*r.length,n=new Uint32Array(oe(c)),o=0;o<c;o+=8)n[o>>5]|=(255&r[o/8])<<o%32;return n}(t),8*t.length))}),Ke=Me;function _e(t,e,i,r){switch(t){case 0:return e&i^~e&r;case 1:case 3:return e^i^r;case 2:return e&i^e&r^i&r}}function Ut(t,e){return t<<e|t>>>32-e}var ze=ke("v5",80,function(t){var e=[1518500249,1859775393,2400959708,3395469782],i=[1732584193,4023233417,2562383102,271733878,3285377520];if(typeof t=="string"){var r=unescape(encodeURIComponent(t));t=[];for(var c=0;c<r.length;++c)t.push(r.charCodeAt(c))}else Array.isArray(t)||(t=Array.prototype.slice.call(t));t.push(128);for(var n=t.length/4+2,o=Math.ceil(n/16),a=new Array(o),s=0;s<o;++s){for(var u=new Uint32Array(16),l=0;l<16;++l)u[l]=t[64*s+4*l]<<24|t[64*s+4*l+1]<<16|t[64*s+4*l+2]<<8|t[64*s+4*l+3];a[s]=u}a[o-1][14]=8*(t.length-1)/Math.pow(2,32),a[o-1][14]=Math.floor(a[o-1][14]),a[o-1][15]=8*(t.length-1)&4294967295;for(var d=0;d<o;++d){for(var g=new Uint32Array(80),m=0;m<16;++m)g[m]=a[d][m];for(var h=16;h<80;++h)g[h]=Ut(g[h-3]^g[h-8]^g[h-14]^g[h-16],1);for(var b=i[0],P=i[1],y=i[2],w=i[3],O=i[4],T=0;T<80;++T){var S=Math.floor(T/20),N=Ut(b,5)+_e(S,P,y,w)+O+e[S]+g[T]>>>0;O=w,w=y,y=Ut(P,30)>>>0,P=b,b=N}i[0]=i[0]+b>>>0,i[1]=i[1]+P>>>0,i[2]=i[2]+y>>>0,i[3]=i[3]+w>>>0,i[4]=i[4]+O>>>0}return[i[0]>>24&255,i[0]>>16&255,i[0]>>8&255,255&i[0],i[1]>>24&255,i[1]>>16&255,i[1]>>8&255,255&i[1],i[2]>>24&255,i[2]>>16&255,i[2]>>8&255,255&i[2],i[3]>>24&255,i[3]>>16&255,i[3]>>8&255,255&i[3],i[4]>>24&255,i[4]>>16&255,i[4]>>8&255,255&i[4]]}),Je=ze,qt=Object.freeze({__proto__:null,v1:function(t,e,i){var r=e&&i||0,c=e||new Array(16),n=(t=t||{}).node||re,o=t.clockseq!==void 0?t.clockseq:St;if(n==null||o==null){var a=t.random||(t.rng||ne)();n==null&&(n=re=[1|a[0],a[1],a[2],a[3],a[4],a[5]]),o==null&&(o=St=16383&(a[6]<<8|a[7]))}var s=t.msecs!==void 0?t.msecs:Date.now(),u=t.nsecs!==void 0?t.nsecs:Lt+1,l=s-Ot+(u-Lt)/1e4;if(l<0&&t.clockseq===void 0&&(o=o+1&16383),(l<0||s>Ot)&&t.nsecs===void 0&&(u=0),u>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");Ot=s,Lt=u,St=o;var d=(1e4*(268435455&(s+=122192928e5))+u)%4294967296;c[r++]=d>>>24&255,c[r++]=d>>>16&255,c[r++]=d>>>8&255,c[r++]=255&d;var g=s/4294967296*1e4&268435455;c[r++]=g>>>8&255,c[r++]=255&g,c[r++]=g>>>24&15|16,c[r++]=g>>>16&255,c[r++]=o>>>8|128,c[r++]=255&o;for(var m=0;m<6;++m)c[r+m]=n[m];return e||gt(c)},v3:Ke,v4:function(t,e,i){var r=(t=t||{}).random||(t.rng||ne)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,e){i=i||0;for(var c=0;c<16;++c)e[i+c]=r[c];return e}return gt(r)},v5:Je,NIL:"00000000-0000-0000-0000-000000000000",version:function(t){if(!vt(t))throw TypeError("Invalid UUID");return parseInt(t.substr(14,1),16)},validate:vt,stringify:gt,parse:be});const it=["debug","info","warn","error","none"];var Mt={commonBasicLogger:function(t,e){if(t&&t.destination&&typeof t.destination!="function")throw new Error("destination for basicLogger was set to a non-function");function i(u){return function(l){console&&console[u]&&console[u].call(console,l)}}const r=t&&t.destination?[t.destination,t.destination,t.destination,t.destination]:[i("log"),i("info"),i("warn"),i("error")],c=!(!t||!t.destination),n=t&&t.prefix!==void 0&&t.prefix!==null?t.prefix:"[LaunchDarkly] ";let o=1;if(t&&t.level)for(let u=0;u<it.length;u++)it[u]===t.level&&(o=u);function a(u,l,d){if(d.length<1)return;let g;const m=c?l+": "+n:n;if(d.length!==1&&e){const h=[...d];h[0]=m+h[0],g=e(...h)}else g=m+d[0];try{r[u](g)}catch(h){console&&console.log&&console.log("[LaunchDarkly] Configured logger's "+l+" method threw an exception: "+h)}}const s={};for(let u=0;u<it.length;u++){const l=it[u];if(l!=="none")if(u<o)s[l]=()=>{};else{const d=u;s[l]=function(){a(d,l,arguments)}}}return s},validateLogger:function(t){it.forEach(e=>{if(e!=="none"&&(!t[e]||typeof t[e]!="function"))throw new Error("Provided logger instance must support logger."+e+"(...) method")})}};function ct(t){return t&&t.message?t.message:typeof t=="string"||t instanceof String?t:JSON.stringify(t)}const rt=" Please see https://docs.launchdarkly.com/sdk/client-side/javascript#initializing-the-client for instructions on SDK initialization.";var E={bootstrapInvalid:function(){return"LaunchDarkly bootstrap data is not available because the back end could not read the flags."},bootstrapOldFormat:function(){return"LaunchDarkly client was initialized with bootstrap data that did not include flag metadata. Events may not be sent correctly."+rt},clientInitialized:function(){return"LaunchDarkly client initialized"},clientNotReady:function(){return"LaunchDarkly client is not ready"},debugEnqueueingEvent:function(t){return'enqueueing "'+t+'" event'},debugPostingDiagnosticEvent:function(t){return"sending diagnostic event ("+t.kind+")"},debugPostingEvents:function(t){return"sending "+t+" events"},debugStreamDelete:function(t){return'received streaming deletion for flag "'+t+'"'},debugStreamDeleteIgnored:function(t){return'received streaming deletion for flag "'+t+'" but ignored due to version check'},debugStreamPatch:function(t){return'received streaming update for flag "'+t+'"'},debugStreamPatchIgnored:function(t){return'received streaming update for flag "'+t+'" but ignored due to version check'},debugStreamPing:function(){return"received ping message from stream"},debugPolling:function(t){return"polling for feature flags at "+t},debugStreamPut:function(){return"received streaming update for all flags"},deprecated:function(t,e){return e?'"'+t+'" is deprecated, please use "'+e+'"':'"'+t+'" is deprecated'},environmentNotFound:function(){return"Environment not found. Double check that you specified a valid environment/client-side ID."+rt},environmentNotSpecified:function(){return"No environment/client-side ID was specified."+rt},errorFetchingFlags:function(t){return"Error fetching flag settings: "+ct(t)},eventCapacityExceeded:function(){return"Exceeded event queue capacity. Increase capacity to avoid dropping events."},eventWithoutContext:function(){return"Be sure to call `identify` in the LaunchDarkly client: https://docs.launchdarkly.com/sdk/features/identify#javascript"},httpErrorMessage:function(t,e,i){return"Received error "+t+(t===401?" (invalid SDK key)":"")+" for "+e+" - "+(F.isHttpErrorRecoverable(t)?i:"giving up permanently")},httpUnavailable:function(){return"Cannot make HTTP requests in this environment."+rt},identifyDisabled:function(){return"identify() has no effect here; it must be called on the main client instance"},inspectorMethodError:(t,e)=>`an inspector: "${e}" of type: "${t}" generated an exception`,invalidContentType:function(t){return'Expected application/json content type but got "'+t+'"'},invalidData:function(){return"Invalid data received from LaunchDarkly; connection may have been interrupted"},invalidInspector:(t,e)=>`an inspector: "${e}" of an invalid type (${t}) was configured`,invalidKey:function(){return"Event key must be a string"},invalidContext:function(){return"Invalid context specified."+rt},invalidTagValue:t=>`Config option "${t}" must only contain letters, numbers, ., _ or -.`,localStorageUnavailable:function(t){return"local storage is unavailable: "+ct(t)},networkError:t=>"network error"+(t?" ("+t+")":""),optionBelowMinimum:(t,e,i)=>'Config option "'+t+'" was set to '+e+", changing to minimum value of "+i,streamClosing:function(){return"Closing stream connection"},streamConnecting:function(t){return"Opening stream connection to "+t},streamError:function(t,e){return"Error on stream connection: "+ct(t)+", will continue retrying after "+e+" milliseconds."},tagValueTooLong:t=>`Value of "${t}" was longer than 64 characters and was discarded.`,unknownCustomEventKey:function(t){return'Custom event "'+t+'" does not exist'},unknownOption:t=>'Ignoring unknown config option "'+t+'"',contextNotSpecified:function(){return"No context specified."+rt},unrecoverableStreamError:t=>`Error on stream connection ${ct(t)}, giving up permanently`,wrongOptionType:(t,e,i)=>'Config option "'+t+'" should be of type '+e+", got "+i+", using default value",wrongOptionTypeBoolean:(t,e)=>'Config option "'+t+'" should be a boolean, got '+e+", converting to boolean"};const{validateLogger:Be}=Mt,ie={baseUrl:{default:"https://app.launchdarkly.com"},streamUrl:{default:"https://clientstream.launchdarkly.com"},eventsUrl:{default:"https://events.launchdarkly.com"},sendEvents:{default:!0},streaming:{type:"boolean"},sendLDHeaders:{default:!0},requestHeaderTransform:{type:"function"},sendEventsOnlyForVariation:{default:!1},useReport:{default:!1},evaluationReasons:{default:!1},eventCapacity:{default:100,minimum:1},flushInterval:{default:2e3,minimum:2e3},samplingInterval:{default:0,minimum:0},streamReconnectDelay:{default:1e3,minimum:0},allAttributesPrivate:{default:!1},privateAttributes:{default:[]},bootstrap:{type:"string|object"},diagnosticRecordingInterval:{default:9e5,minimum:2e3},diagnosticOptOut:{default:!1},wrapperName:{type:"string"},wrapperVersion:{type:"string"},stateProvider:{type:"object"},application:{validator:function(t,e,i){const r={};return e.id&&(r.id=ae(`${t}.id`,e.id,i)),e.version&&(r.version=ae(`${t}.version`,e.version,i)),r}},inspectors:{default:[]}},Ge=/^(\w|\.|-)+$/;function Tt(t){return t&&t.replace(/\/+$/,"")}function ae(t,e,i){if(typeof e=="string"&&e.match(Ge)){if(!(e.length>64))return e;i.warn(E.tagValueTooLong(t))}else i.warn(E.invalidTagValue(t))}var Kt={baseOptionDefs:ie,validate:function(t,e,i,r){const c=D.extend({logger:{default:r}},ie,i),n={};function o(s){D.onNextTick(()=>{e&&e.maybeReportError(new F.LDInvalidArgumentError(s))})}let a=D.extend({},t||{});return function(s){const u=s;Object.keys(n).forEach(l=>{if(u[l]!==void 0){const d=n[l];r&&r.warn(E.deprecated(l,d)),d&&(u[d]===void 0&&(u[d]=u[l]),delete u[l])}})}(a),a=function(s){const u=D.extend({},s);return Object.keys(c).forEach(l=>{u[l]!==void 0&&u[l]!==null||(u[l]=c[l]&&c[l].default)}),u}(a),a=function(s){const u=D.extend({},s),l=d=>{if(d===null)return"any";if(d===void 0)return;if(Array.isArray(d))return"array";const g=typeof d;return g==="boolean"||g==="string"||g==="number"||g==="function"?g:"object"};return Object.keys(s).forEach(d=>{const g=s[d];if(g!=null){const m=c[d];if(m===void 0)o(E.unknownOption(d));else{const h=m.type||l(m.default),b=m.validator;if(b){const P=b(d,s[d],r);P!==void 0?u[d]=P:delete u[d]}else if(h!=="any"){const P=h.split("|"),y=l(g);P.indexOf(y)<0?h==="boolean"?(u[d]=!!g,o(E.wrongOptionTypeBoolean(d,y))):(o(E.wrongOptionType(d,h,y)),u[d]=m.default):y==="number"&&m.minimum!==void 0&&g<m.minimum&&(o(E.optionBelowMinimum(d,g,m.minimum)),u[d]=m.minimum)}}}}),u.baseUrl=Tt(u.baseUrl),u.streamUrl=Tt(u.streamUrl),u.eventsUrl=Tt(u.eventsUrl),u}(a),Be(a.logger),a},getTags:function(t){const e={};return t&&(t.application&&t.application.id!==void 0&&t.application.id!==null&&(e["application-id"]=[t.application.id]),t.application&&t.application.version!==void 0&&t.application.id!==null&&(e["application-version"]=[t.application.version])),e}};const{getLDUserAgentString:We}=D;var _t={getLDHeaders:function(t,e){if(e&&!e.sendLDHeaders)return{};const i={};i[t.userAgentHeaderName||"User-Agent"]=We(t),e&&e.wrapperName&&(i["X-LaunchDarkly-Wrapper"]=e.wrapperVersion?e.wrapperName+"/"+e.wrapperVersion:e.wrapperName);const r=Kt.getTags(e),c=Object.keys(r);return c.length&&(i["x-launchdarkly-tags"]=c.sort().map(n=>Array.isArray(r[n])?r[n].sort().map(o=>`${n}/${o}`):[`${n}/${r[n]}`]).reduce((n,o)=>n.concat(o),[]).join(" ")),i},transformHeaders:function(t,e){return e&&e.requestHeaderTransform?e.requestHeaderTransform({...t}):t}};const{v1:Xe}=qt,{getLDHeaders:Ye,transformHeaders:Qe}=_t;var Ee=function(t,e,i){const r="/a/"+e+".gif",c=D.extend({"Content-Type":"application/json"},Ye(t,i)),n=t.httpFallbackPing,o={};return o.sendChunk=(a,s,u,l)=>{const d=JSON.stringify(a),g=u?null:Xe();return l?function m(h){const b=u?c:D.extend({},c,{"X-LaunchDarkly-Event-Schema":"4","X-LaunchDarkly-Payload-ID":g});return t.httpRequest("POST",s,Qe(b,i),d).promise.then(P=>{if(P)return P.status>=400&&F.isHttpErrorRecoverable(P.status)&&h?m(!1):function(y){const w={status:y.status},O=y.header("date");if(O){const T=Date.parse(O);T&&(w.serverTime=T)}return w}(P)}).catch(()=>h?m(!1):Promise.reject())}(!0).catch(()=>{}):(n&&n(s+r+"?d="+D.base64URLEncode(d)),Promise.resolve())},o.sendEvents=function(a,s,u){if(!t.httpRequest)return Promise.resolve();const l=t.httpAllowsPost();let d;d=l?[a]:D.chunkEventsForUrl(2e3-s.length,a);const g=[];for(let m=0;m<d.length;m++)g.push(o.sendChunk(d[m],s,u,l));return Promise.all(g)},o};const{commonBasicLogger:Ze}=Mt;function se(t){return typeof t=="string"&&t!=="kind"&&t.match(/^(\w|\.|-)+$/)}function ce(t){return t.includes("%")||t.includes(":")?t.replace(/%/g,"%25").replace(/:/g,"%3A"):t}var mt={checkContext:function(t,e){if(t){if(e&&(t.kind===void 0||t.kind===null))return t.key!==void 0&&t.key!==null;const i=t.key,r=t.kind===void 0?"user":t.kind,c=se(r),n=r==="multi"||i!=null&&i!=="";if(r==="multi"){const o=Object.keys(t).filter(a=>a!=="kind");return n&&o.every(a=>se(a))&&o.every(a=>{const s=t[a].key;return s!=null&&s!==""})}return n&&c}return!1},getContextKeys:function(t,e=Ze()){if(!t)return;const i={},{kind:r,key:c}=t;switch(r){case void 0:i.user=`${c}`;break;case"multi":Object.entries(t).filter(([n])=>n!=="kind").forEach(([n,o])=>{o&&o.key&&(i[n]=o.key)});break;case null:e.warn(`null is not a valid context kind: ${t}`);break;case"":e.warn(`'' is not a valid context kind: ${t}`);break;default:i[r]=`${c}`}return i},getContextKinds:function(t){return t?t.kind===null||t.kind===void 0?["user"]:t.kind!=="multi"?[t.kind]:Object.keys(t).filter(e=>e!=="kind"):[]},getCanonicalKey:function(t){if(t){if((t.kind===void 0||t.kind===null||t.kind==="user")&&t.key)return t.key;if(t.kind!=="multi"&&t.key)return`${t.kind}:${ce(t.key)}`;if(t.kind==="multi")return Object.keys(t).sort().filter(e=>e!=="kind").map(e=>`${e}:${ce(t[e].key)}`).join(":")}}};const{getContextKinds:tn}=mt;var en=function(){const t={};let e=0,i=0,r={},c={};return t.summarizeEvent=n=>{if(n.kind==="feature"){const o=n.key+":"+(n.variation!==null&&n.variation!==void 0?n.variation:"")+":"+(n.version!==null&&n.version!==void 0?n.version:""),a=r[o];let s=c[n.key];s||(s=new Set,c[n.key]=s),function(u){return u.context?tn(u.context):u.contextKeys?Object.keys(u.contextKeys):[]}(n).forEach(u=>s.add(u)),a?a.count=a.count+1:r[o]={count:1,key:n.key,version:n.version,variation:n.variation,value:n.value,default:n.default},(e===0||n.creationDate<e)&&(e=n.creationDate),n.creationDate>i&&(i=n.creationDate)}},t.getSummary=()=>{const n={};let o=!0;for(const a of Object.values(r)){let s=n[a.key];s||(s={default:a.default,counters:[],contextKinds:[...c[a.key]]},n[a.key]=s);const u={value:a.value,count:a.count};a.variation!==void 0&&a.variation!==null&&(u.variation=a.variation),a.version!==void 0&&a.version!==null?u.version=a.version:u.unknown=!0,s.counters.push(u),o=!1}return o?null:{startDate:e,endDate:i,features:n}},t.clearSummary=()=>{e=0,i=0,r={},c={}},t};function De(t){return t.replace(/~/g,"~0").replace(/\//g,"~1")}function ue(t){return(t.startsWith("/")?t.substring(1):t).split("/").map(e=>e.indexOf("~")>=0?e.replace(/~1/g,"/").replace(/~0/g,"~"):e)}function le(t){return!t.startsWith("/")}function de(t,e){const i=le(t),r=le(e);if(i&&r)return t===e;if(i){const c=ue(e);return c.length===1&&t===c[0]}if(r){const c=ue(t);return c.length===1&&e===c[0]}return t===e}function fe(t){return`/${De(t)}`}var Rt={cloneExcluding:function(t,e){const i=[],r={},c=[];for(i.push(...Object.keys(t).map(n=>({key:n,ptr:fe(n),source:t,parent:r,visited:[t]})));i.length;){const n=i.pop();if(e.some(o=>de(o,n.ptr)))c.push(n.ptr);else{const o=n.source[n.key];if(o===null)n.parent[n.key]=o;else if(Array.isArray(o))n.parent[n.key]=[...o];else if(typeof o=="object"){if(n.visited.includes(o))continue;n.parent[n.key]={},i.push(...Object.keys(o).map(a=>{return{key:a,ptr:(s=n.ptr,u=De(a),`${s}/${u}`),source:o,parent:n.parent[n.key],visited:[...n.visited,o]};var s,u}))}else n.parent[n.key]=o}}return{cloned:r,excluded:c.sort()}},compare:de,literalToReference:fe},nn=function(t){const e={},i=t.allAttributesPrivate,r=t.privateAttributes||[],c=["key","kind","_meta","anonymous"],n=["name","ip","firstName","lastName","email","avatar","country"],o=a=>{if(typeof a!="object"||a===null||Array.isArray(a))return;const{cloned:s,excluded:u}=Rt.cloneExcluding(a,(l=>(i?Object.keys(l):[...r,...l._meta&&l._meta.privateAttributes||[]]).filter(d=>!c.some(g=>Rt.compare(d,g))))(a));return s.key=String(s.key),u.length&&(s._meta||(s._meta={}),s._meta.redactedAttributes=u),s._meta&&(delete s._meta.privateAttributes,Object.keys(s._meta).length===0&&delete s._meta),s.anonymous!==void 0&&(s.anonymous=!!s.anonymous),s};return e.filter=a=>a.kind===void 0||a.kind===null?o((s=>{const u={...s.custom||{},kind:"user",key:s.key};s.anonymous!==void 0&&(u.anonymous=!!s.anonymous);for(const l of n)delete u[l],s[l]!==void 0&&s[l]!==null&&(u[l]=String(s[l]));return s.privateAttributeNames!==void 0&&s.privateAttributeNames!==null&&(u._meta=u._meta||{},u._meta.privateAttributes=s.privateAttributeNames.map(l=>l.startsWith("/")?Rt.literalToReference(l):l)),u})(a)):a.kind==="multi"?(s=>{const u={kind:s.kind},l=Object.keys(s);for(const d of l)if(d!=="kind"){const g=o(s[d]);g&&(u[d]=g)}return u})(a):o(a),e};const{getContextKeys:rn}=mt;var on=function(t,e,i,r=null,c=null,n=null){const o={},a=n||Ee(t,i,e),s=D.appendUrlPath(e.eventsUrl,"/events/bulk/"+i),u=en(),l=nn(e),d=e.samplingInterval,g=e.eventCapacity,m=e.flushInterval,h=e.logger;let b,P=[],y=0,w=!1,O=!1;function T(){return d===0||Math.floor(Math.random()*d)===0}function S(C){const A=D.extend({},C);return C.kind==="identify"?A.context=l.filter(C.context):(A.contextKeys=rn(C.context,h),delete A.context),C.kind==="feature"&&(delete A.trackEvents,delete A.debugEventsUntilDate),A}function N(C){P.length<g?(P.push(C),O=!1):(O||(O=!0,h.warn(E.eventCapacityExceeded())),r&&r.incrementDroppedEvents())}return o.enqueue=function(C){if(w)return;let A=!1,k=!1;var x;if(u.summarizeEvent(C),C.kind==="feature"?T()&&(A=!!C.trackEvents,k=!!(x=C).debugEventsUntilDate&&x.debugEventsUntilDate>y&&x.debugEventsUntilDate>new Date().getTime()):A=T(),A&&N(S(C)),k){const R=D.extend({},C,{kind:"debug"});R.context=l.filter(R.context),delete R.trackEvents,delete R.debugEventsUntilDate,N(R)}},o.flush=function(){if(w)return Promise.resolve();const C=P,A=u.getSummary();return u.clearSummary(),A&&(A.kind="summary",C.push(A)),r&&r.setEventsInLastBatch(C.length),C.length===0?Promise.resolve():(P=[],h.debug(E.debugPostingEvents(C.length)),a.sendEvents(C,s).then(k=>{const x=k&&k[0];x&&(x.serverTime&&(y=x.serverTime),F.isHttpErrorRecoverable(x.status)||(w=!0),x.status>=400&&D.onNextTick(()=>{c.maybeReportError(new F.LDUnexpectedResponseError(E.httpErrorMessage(x.status,"event posting","some events were dropped")))}))}))},o.start=function(){const C=()=>{o.flush(),b=setTimeout(C,m)};b=setTimeout(C,m)},o.stop=function(){clearTimeout(b)},o},an=function(t){const e={},i={};return e.on=function(r,c,n){i[r]=i[r]||[],i[r]=i[r].concat({handler:c,context:n})},e.off=function(r,c,n){if(i[r])for(let o=0;o<i[r].length;o++)i[r][o].handler===c&&i[r][o].context===n&&(i[r]=i[r].slice(0,o).concat(i[r].slice(o+1)))},e.emit=function(r){if(!i[r])return;const c=i[r].slice(0);for(let n=0;n<c.length;n++)c[n].handler.apply(c[n].context,Array.prototype.slice.call(arguments,1))},e.getEvents=function(){return Object.keys(i)},e.getEventListenerCount=function(r){return i[r]?i[r].length:0},e.maybeReportError=function(r){r&&(i.error?this.emit("error",r):(t||console).error(r.message))},e};const ut="ready",At="initialized",jt="failed";var sn=function(t){let e=!1,i=!1,r=null,c=null;const n=new Promise(o=>{const a=()=>{t.off(ut,a),o()};t.on(ut,a)}).catch(()=>{});return{getInitializationPromise:()=>c||(e?Promise.resolve():i?Promise.reject(r):(c=new Promise((o,a)=>{const s=()=>{t.off(At,s),o()},u=l=>{t.off(jt,u),a(l)};t.on(At,s),t.on(jt,u)}),c)),getReadyPromise:()=>n,signalSuccess:()=>{e||i||(e=!0,t.emit(At),t.emit(ut))},signalFailure:o=>{e||i||(i=!0,r=o,t.emit(jt,o),t.emit(ut)),t.maybeReportError(o)}}},cn=function(t,e,i,r){const c={};function n(){let o="";const a=r.getContext();return a&&(o=i||D.btoa(JSON.stringify(a))),"ld:"+e+":"+o}return c.loadFlags=()=>t.get(n()).then(o=>{if(o==null)return null;try{let a=JSON.parse(o);if(a){const s=a.$schema;s===void 0||s<1?a=D.transformValuesToVersionedValues(a):delete a.$schema}return a}catch{return c.clearFlags().then(()=>null)}}),c.saveFlags=o=>{const a=D.extend({},o,{$schema:1});return t.set(n(),JSON.stringify(a))},c.clearFlags=()=>t.clear(n()),c},un=function(t,e){const i={};let r=!1;const c=n=>{r||(r=!0,e.warn(E.localStorageUnavailable(n)))};return i.isEnabled=()=>!!t,i.get=n=>new Promise(o=>{t?t.get(n).then(o).catch(a=>{c(a),o(void 0)}):o(void 0)}),i.set=(n,o)=>new Promise(a=>{t?t.set(n,o).then(()=>a(!0)).catch(s=>{c(s),a(!1)}):a(!1)}),i.clear=n=>new Promise(o=>{t?t.clear(n).then(()=>o(!0)).catch(a=>{c(a),o(!1)}):o(!1)}),i};const{appendUrlPath:ge,base64URLEncode:ln,objectHasOwnProperty:dn}=D,{getLDHeaders:fn,transformHeaders:gn}=_t,{isHttpErrorRecoverable:vn}=F;var pn=function(t,e,i,r){const c=e.streamUrl,n=e.logger,o={},a=ge(c,"/eval/"+i),s=e.useReport,u=e.evaluationReasons,l=e.streamReconnectDelay,d=fn(t,e);let g,m=!1,h=null,b=null,P=null,y=null,w=null,O=0;function T(){const x=(R=function(){const $=l*Math.pow(2,O);return $>3e4?3e4:$}(),R-Math.trunc(.5*Math.random()*R));var R;return O+=1,x}function S(x){if(x.status&&typeof x.status=="number"&&!vn(x.status))return A(),n.error(E.unrecoverableStreamError(x)),void(b&&(clearTimeout(b),b=null));const R=T();m||(n.warn(E.streamError(x,R)),m=!0),k(!1),A(),N(R)}function N(x){b||(x?b=setTimeout(C,x):C())}function C(){let x;b=null;let R="";const $={headers:d,readTimeoutMillis:3e5};if(t.eventSourceFactory){y!=null&&(R="h="+y),s?t.eventSourceAllowsReport?(x=a,$.method="REPORT",$.headers["Content-Type"]="application/json",$.body=JSON.stringify(P)):(x=ge(c,"/ping/"+i),R=""):x=a+"/"+ln(JSON.stringify(P)),$.headers=gn($.headers,e),u&&(R=R+(R?"&":"")+"withReasons=true"),x=x+(R?"?":"")+R,A(),n.info(E.streamConnecting(x)),g=new Date().getTime(),h=t.eventSourceFactory(x,$);for(const W in w)dn(w,W)&&h.addEventListener(W,w[W]);h.onerror=S,h.onopen=()=>{O=0}}}function A(){h&&(n.info(E.streamClosing()),h.close(),h=null)}function k(x){g&&r&&r.recordStreamInit(g,!x,new Date().getTime()-g),g=null}return o.connect=function(x,R,$){P=x,y=R,w={};for(const W in $||{})w[W]=function(B){m=!1,k(!0),$[W]&&$[W](B)};N()},o.disconnect=function(){clearTimeout(b),b=null,A()},o.isConnected=function(){return!!(h&&t.eventSourceIsActive&&t.eventSourceIsActive(h))},o},mn=function(t){let e,i,r,c;const n={addPromise:(o,a)=>{e=o,i&&i(),i=a,o.then(s=>{e===o&&(r(s),t&&t())},s=>{e===o&&(c(s),t&&t())})}};return n.resultPromise=new Promise((o,a)=>{r=o,c=a}),n};const{transformHeaders:hn,getLDHeaders:yn}=_t,Nt="application/json";var wn=function(t,e,i){const r=e.baseUrl,c=e.useReport,n=e.evaluationReasons,o=e.logger,a={},s={};function u(l,d){if(!t.httpRequest)return new Promise((y,w)=>{w(new F.LDFlagFetchError(E.httpUnavailable()))});const g=d?"REPORT":"GET",m=yn(t,e);d&&(m["Content-Type"]=Nt);let h=s[l];h||(h=mn(()=>{delete s[l]}),s[l]=h);const b=t.httpRequest(g,l,hn(m,e),d),P=b.promise.then(y=>{if(y.status===200){if(y.header("content-type")&&y.header("content-type").substring(0,Nt.length)===Nt)return JSON.parse(y.body);{const w=E.invalidContentType(y.header("content-type")||"");return Promise.reject(new F.LDFlagFetchError(w))}}return Promise.reject(function(w){return w.status===404?new F.LDInvalidEnvironmentIdError(E.environmentNotFound()):new F.LDFlagFetchError(E.errorFetchingFlags(w.statusText||String(w.status)))}(y))},y=>Promise.reject(new F.LDFlagFetchError(E.networkError(y))));return h.addPromise(P,()=>{b.cancel&&b.cancel()}),h.resultPromise}return a.fetchJSON=function(l){return u(D.appendUrlPath(r,l),null)},a.fetchFlagSettings=function(l,d){let g,m,h,b="";return c?(m=[r,"/sdk/evalx/",i,"/context"].join(""),h=JSON.stringify(l)):(g=D.base64URLEncode(JSON.stringify(l)),m=[r,"/sdk/evalx/",i,"/contexts/",g].join("")),d&&(b="h="+d),n&&(b=b+(b?"&":"")+"withReasons=true"),m=m+(b?"?":"")+b,o.debug(E.debugPolling(m)),u(m,h)},a},bn=function(t,e){const i={};let r;return i.setContext=function(c){r=D.sanitizeContext(c),r&&e&&e(D.clone(r))},i.getContext=function(){return r?D.clone(r):null},t&&i.setContext(t),i};const{v1:kn}=qt,{getContextKinds:En}=mt;var Dn=function(t){function e(r){return r==null||r==="user"?"ld:$anonUserId":`ld:$contextKey:${r}`}function i(r,c){return c.key!==null&&c.key!==void 0?(c.key=c.key.toString(),Promise.resolve(c)):c.anonymous?function(n){return t.get(e(n))}(r).then(n=>{if(n)return c.key=n,c;{const o=kn();return c.key=o,function(a,s){return t.set(e(s),a)}(o,r).then(()=>c)}}):Promise.reject(new F.LDInvalidUserError(E.invalidContext()))}this.processContext=r=>{if(!r)return Promise.reject(new F.LDInvalidUserError(E.contextNotSpecified()));const c=D.clone(r);if(r.kind==="multi"){const n=En(c);return Promise.all(n.map(o=>i(o,c[o]))).then(()=>c)}return i(r.kind,c)}};const{v1:Cn}=qt,{baseOptionDefs:Ft}=Kt,{appendUrlPath:xn}=D;var $t={DiagnosticId:function(t){const e={diagnosticId:Cn()};return t&&(e.sdkKeySuffix=t.length>6?t.substring(t.length-6):t),e},DiagnosticsAccumulator:function(t){let e,i,r,c;function n(o){e=o,i=0,r=0,c=[]}return n(t),{getProps:()=>({dataSinceDate:e,droppedEvents:i,eventsInLastBatch:r,streamInits:c}),setProps:o=>{e=o.dataSinceDate,i=o.droppedEvents||0,r=o.eventsInLastBatch||0,c=o.streamInits||[]},incrementDroppedEvents:()=>{i++},setEventsInLastBatch:o=>{r=o},recordStreamInit:(o,a,s)=>{const u={timestamp:o,failed:a,durationMillis:s};c.push(u)},reset:n}},DiagnosticsManager:function(t,e,i,r,c,n,o){const a=!!t.diagnosticUseCombinedEvent,s="ld:"+c+":$diagnostics",u=xn(n.eventsUrl,"/events/diagnostic/"+c),l=n.diagnosticRecordingInterval,d=i;let g,m,h=!!n.streaming;const b={};function P(){return{sdk:O(),configuration:T(),platform:t.diagnosticPlatformData}}function y(S){n.logger&&n.logger.debug(E.debugPostingDiagnosticEvent(S)),r.sendEvents(S,u,!0).then(()=>{}).catch(()=>{})}function w(){y(function(){const S=new Date().getTime();let N={kind:a?"diagnostic-combined":"diagnostic",id:o,creationDate:S,...d.getProps()};return a&&(N={...N,...P()}),d.reset(S),N}()),m=setTimeout(w,l),g=new Date().getTime(),a&&function(){if(e.isEnabled()){const S={...d.getProps()};e.set(s,JSON.stringify(S))}}()}function O(){const S={...t.diagnosticSdkData};return n.wrapperName&&(S.wrapperName=n.wrapperName),n.wrapperVersion&&(S.wrapperVersion=n.wrapperVersion),S}function T(){return{customBaseURI:n.baseUrl!==Ft.baseUrl.default,customStreamURI:n.streamUrl!==Ft.streamUrl.default,customEventsURI:n.eventsUrl!==Ft.eventsUrl.default,eventsCapacity:n.eventCapacity,eventsFlushIntervalMillis:n.flushInterval,reconnectTimeMillis:n.streamReconnectDelay,streamingDisabled:!h,allAttributesPrivate:!!n.allAttributesPrivate,diagnosticRecordingIntervalMillis:n.diagnosticRecordingInterval,usingSecureMode:!!n.hash,bootstrapMode:!!n.bootstrap,fetchGoalsDisabled:!n.fetchGoals,sendEventsOnlyForVariation:!!n.sendEventsOnlyForVariation}}return b.start=()=>{a?function(S){if(!e.isEnabled())return S(!1);e.get(s).then(N=>{if(N)try{const C=JSON.parse(N);d.setProps(C),g=C.dataSinceDate}catch{}S(!0)}).catch(()=>{S(!1)})}(S=>{if(S){const N=(g||0)+l,C=new Date().getTime();C>=N?w():m=setTimeout(w,N-C)}else Math.floor(4*Math.random())===0?w():m=setTimeout(w,l)}):(y({kind:"diagnostic-init",id:o,creationDate:d.getProps().dataSinceDate,...P()}),m=setTimeout(w,l))},b.stop=()=>{m&&clearTimeout(m)},b.setStreaming=S=>{h=S},b}},Pn=function(t,e){let i=!1;const r={type:t.type,name:t.name,method:(...c)=>{try{t.method(...c)}catch{i||(i=!0,e.warn(E.inspectorMethodError(r.type,r.name)))}}};return r};const{onNextTick:lt}=D,J={flagUsed:"flag-used",flagDetailsChanged:"flag-details-changed",flagDetailChanged:"flag-detail-changed",clientIdentityChanged:"client-identity-changed"};Object.freeze(J);var Sn={InspectorTypes:J,InspectorManager:function(t,e){const i={},r={[J.flagUsed]:[],[J.flagDetailsChanged]:[],[J.flagDetailChanged]:[],[J.clientIdentityChanged]:[]},c=t&&t.map(n=>Pn(n,e));return c&&c.forEach(n=>{Object.prototype.hasOwnProperty.call(r,n.type)?r[n.type].push(n):e.warn(E.invalidInspector(n.type,n.name))}),i.hasListeners=n=>r[n]&&r[n].length,i.onFlagUsed=(n,o,a)=>{r[J.flagUsed].length&&lt(()=>{r[J.flagUsed].forEach(s=>s.method(n,o,a))})},i.onFlags=n=>{r[J.flagDetailsChanged].length&&lt(()=>{r[J.flagDetailsChanged].forEach(o=>o.method(n))})},i.onFlagChanged=(n,o)=>{r[J.flagDetailChanged].length&&lt(()=>{r[J.flagDetailChanged].forEach(a=>a.method(n,o))})},i.onIdentityChanged=n=>{r[J.clientIdentityChanged].length&&lt(()=>{r[J.clientIdentityChanged].forEach(o=>o.method(n))})},i}};const{commonBasicLogger:ve}=Mt,{checkContext:In,getContextKeys:On}=mt,{InspectorTypes:dt,InspectorManager:Ln}=Sn,at="change",pe="internal-change";var ht={initialize:function(t,e,i,r,c){const n=function(){return i&&i.logger?i.logger:c&&c.logger&&c.logger.default||ve("warn")}(),o=an(n),a=sn(o),s=Kt.validate(i,o,c,n),u=Ln(s.inspectors,n),l=s.sendEvents;let d=t,g=s.hash;const m=un(r.localStorage,n),h=Ee(r,d,s),b=s.sendEvents&&!s.diagnosticOptOut,P=b?$t.DiagnosticId(d):null,y=b?$t.DiagnosticsAccumulator(new Date().getTime()):null,w=b?$t.DiagnosticsManager(r,m,y,h,d,s,P):null,O=pn(r,s,d,y),T=s.eventProcessor||on(r,s,d,y,o,h),S=wn(r,s,d);let N,C,A,k={},x=s.streaming,R=!1,$=!1,W=!0;const B=s.stateProvider,V=bn(null,function(f){(function(p){B||p&&st({kind:"identify",context:p,creationDate:new Date().getTime()})})(f),u.hasListeners(dt.clientIdentityChanged)&&u.onIdentityChanged(V.getContext())}),zt=new Dn(m),Z=m.isEnabled()?cn(m,d,g,V):null;function st(f){d&&(B&&B.enqueueEvent&&B.enqueueEvent(f)||(f.context?(W=!1,!l||$||r.isDoNotTrack()||(n.debug(E.debugEnqueueingEvent(f.kind)),T.enqueue(f))):W&&(n.warn(E.eventWithoutContext()),W=!1)))}function Jt(f,p){u.hasListeners(dt.flagDetailChanged)&&u.onFlagChanged(f.key,tt(p))}function Bt(){u.hasListeners(dt.flagDetailsChanged)&&u.onFlags(Object.entries(k).map(([f,p])=>({key:f,detail:tt(p)})).reduce((f,p)=>(f[p.key]=p.detail,f),{}))}function Gt(f,p,v,I){const L=V.getContext(),j=new Date,U={kind:"feature",key:f,context:L,value:p?p.value:null,variation:p?p.variationIndex:null,default:v,creationDate:j.getTime()},z=k[f];z&&(U.version=z.flagVersion?z.flagVersion:z.version,U.trackEvents=z.trackEvents,U.debugEventsUntilDate=z.debugEventsUntilDate),(I||z&&z.trackReason)&&p&&(U.reason=p.reason),st(U)}function Wt(f){return In(f,!1)?Promise.resolve(f):Promise.reject(new F.LDInvalidUserError(E.invalidContext()))}function yt(f,p,v,I,L){let j;if(k&&D.objectHasOwnProperty(k,f)&&k[f]&&!k[f].deleted){const U=k[f];j=tt(U),U.value!==null&&U.value!==void 0||(j.value=p)}else j={value:p,variationIndex:null,reason:{kind:"ERROR",errorKind:"FLAG_NOT_FOUND"}};return v&&Gt(f,j,p,I),L||function(U,z){u.hasListeners(dt.flagUsed)&&u.onFlagUsed(U,z,V.getContext())}(f,j),j}function tt(f){return{value:f.value,variationIndex:f.variation===void 0?null:f.variation,reason:f.reason||null}}function Xt(){if(C=!0,!V.getContext())return;const f=p=>{try{return JSON.parse(p)}catch{return void o.maybeReportError(new F.LDInvalidDataError(E.invalidData()))}};O.connect(V.getContext(),g,{ping:function(){n.debug(E.debugStreamPing());const p=V.getContext();S.fetchFlagSettings(p,g).then(v=>{D.deepEquals(p,V.getContext())&&et(v||{})}).catch(v=>{o.maybeReportError(new F.LDFlagFetchError(E.errorFetchingFlags(v)))})},put:function(p){const v=f(p.data);v&&(n.debug(E.debugStreamPut()),et(v))},patch:function(p){const v=f(p.data);if(!v)return;const I=k[v.key];if(!I||!I.version||!v.version||I.version<v.version){n.debug(E.debugStreamPatch(v.key));const L={},j=D.extend({},v);delete j.key,k[v.key]=j;const U=tt(j);L[v.key]=I?{previous:I.value,current:U}:{current:U},bt(L),Jt(v,j)}else n.debug(E.debugStreamPatchIgnored(v.key))},delete:function(p){const v=f(p.data);if(v)if(!k[v.key]||k[v.key].version<v.version){n.debug(E.debugStreamDelete(v.key));const I={};k[v.key]&&!k[v.key].deleted&&(I[v.key]={previous:k[v.key].value}),k[v.key]={version:v.version,deleted:!0},Jt(v,k[v.key]),bt(I)}else n.debug(E.debugStreamDeleteIgnored(v.key))}})}function wt(){C&&(O.disconnect(),C=!1)}function et(f){const p={};if(!f)return Promise.resolve();for(const v in k)D.objectHasOwnProperty(k,v)&&k[v]&&(f[v]&&!D.deepEquals(f[v].value,k[v].value)?p[v]={previous:k[v].value,current:tt(f[v])}:f[v]&&!f[v].deleted||(p[v]={previous:k[v].value}));for(const v in f)D.objectHasOwnProperty(f,v)&&f[v]&&(!k[v]||k[v].deleted)&&(p[v]={current:tt(f[v])});return k={...f},Bt(),bt(p).catch(()=>{})}function bt(f){const p=Object.keys(f);if(p.length>0){const v={};p.forEach(I=>{const L=f[I].current,j=L?L.value:void 0,U=f[I].previous;o.emit(at+":"+I,j,U),v[I]=L?{current:j,previous:U}:{previous:U}}),o.emit(at,v),o.emit(pe,k),s.sendEventsOnlyForVariation||B||p.forEach(I=>{Gt(I,f[I].current)})}return N&&Z?Z.saveFlags(k):Promise.resolve()}function kt(){const f=x||A&&x===void 0;f&&!C?Xt():!f&&C&&wt(),w&&w.setStreaming(f)}function Et(f){return f===at||f.substr(0,at.length+1)===at+":"}if(typeof s.bootstrap=="string"&&s.bootstrap.toUpperCase()==="LOCALSTORAGE"&&(Z?N=!0:n.warn(E.localStorageUnavailable())),typeof s.bootstrap=="object"&&(k=function(f){const p=Object.keys(f),v="$flagsState",I="$valid",L=f[v];!L&&p.length&&n.warn(E.bootstrapOldFormat()),f[I]===!1&&n.warn(E.bootstrapInvalid());const j={};return p.forEach(U=>{if(U!==v&&U!==I){let z={value:f[U]};L&&L[U]?z=D.extend(z,L[U]):z.version=0,j[U]=z}}),j}(s.bootstrap)),B){const f=B.getInitialState();f?Yt(f):B.on("init",Yt),B.on("update",function(p){p.context&&V.setContext(p.context),p.flags&&et(p.flags)})}else(function(){return t?zt.processContext(e).then(Wt).then(f=>(V.setContext(f),typeof s.bootstrap=="object"?ot():N?Z.loadFlags().then(p=>p==null?(k={},S.fetchFlagSettings(V.getContext(),g).then(v=>et(v||{})).then(ot).catch(v=>{Dt(new F.LDFlagFetchError(E.errorFetchingFlags(v)))})):(k=p,D.onNextTick(ot),S.fetchFlagSettings(V.getContext(),g).then(v=>et(v)).catch(v=>o.maybeReportError(v)))):S.fetchFlagSettings(V.getContext(),g).then(p=>{k=p||{},Bt(),ot()}).catch(p=>{k={},Dt(p)}))):Promise.reject(new F.LDInvalidEnvironmentIdError(E.environmentNotSpecified()))})().catch(Dt);function Yt(f){d=f.environment,V.setContext(f.context),k={...f.flags},D.onNextTick(ot)}function ot(){n.info(E.clientInitialized()),R=!0,kt(),a.signalSuccess()}function Dt(f){a.signalFailure(f)}return{client:{waitForInitialization:()=>a.getInitializationPromise(),waitUntilReady:()=>a.getReadyPromise(),identify:function(f,p,v){if($)return D.wrapPromiseCallback(Promise.resolve({}),v);if(B)return n.warn(E.identifyDisabled()),D.wrapPromiseCallback(Promise.resolve(D.transformVersionedValuesToValues(k)),v);const I=N&&Z?Z.clearFlags():Promise.resolve();return D.wrapPromiseCallback(I.then(()=>zt.processContext(f)).then(Wt).then(L=>S.fetchFlagSettings(L,p).then(j=>{const U=D.transformVersionedValuesToValues(j);return V.setContext(L),g=p,j?et(j).then(()=>U):U})).then(L=>(C&&Xt(),L)).catch(L=>(o.maybeReportError(L),Promise.reject(L))),v)},getContext:function(){return V.getContext()},variation:function(f,p){return yt(f,p,!0,!1,!1).value},variationDetail:function(f,p){return yt(f,p,!0,!0,!1)},track:function(f,p,v){if(typeof f!="string")return void o.maybeReportError(new F.LDInvalidEventKeyError(E.unknownCustomEventKey(f)));r.customEventFilter&&!r.customEventFilter(f)&&n.warn(E.unknownCustomEventKey(f));const I=V.getContext(),L={kind:"custom",key:f,context:I,url:r.getCurrentUrl(),creationDate:new Date().getTime()};I&&I.anonymous&&(L.contextKind=I.anonymous?"anonymousUser":"user"),p!=null&&(L.data=p),v!=null&&(L.metricValue=v),st(L)},on:function(f,p,v){Et(f)?(A=!0,R&&kt(),o.on(f,p,v)):o.on(...arguments)},off:function(f){if(o.off(...arguments),Et(f)){let p=!1;o.getEvents().forEach(v=>{Et(v)&&o.getEventListenerCount(v)>0&&(p=!0)}),p||(A=!1,C&&x===void 0&&wt())}},setStreaming:function(f){const p=f===null?void 0:f;p!==x&&(x=p,kt())},flush:function(f){return D.wrapPromiseCallback(l?T.flush():Promise.resolve(),f)},allFlags:function(){const f={};if(!k)return f;for(const p in k)D.objectHasOwnProperty(k,p)&&!k[p].deleted&&(f[p]=yt(p,null,!s.sendEventsOnlyForVariation,!1,!0).value);return f},close:function(f){if($)return D.wrapPromiseCallback(Promise.resolve(),f);const p=()=>{$=!0,k={}},v=Promise.resolve().then(()=>{if(wt(),w&&w.stop(),l)return T.stop(),T.flush()}).then(p).catch(p);return D.wrapPromiseCallback(v,f)}},options:s,emitter:o,ident:V,logger:n,requestor:S,start:function(){l&&(w&&w.start(),T.start())},enqueueEvent:st,getFlagsInternal:function(){return k},getEnvironmentId:()=>d,internalChangeEventName:pe}},commonBasicLogger:ve,errors:F,messages:E,utils:D,getContextKeys:On},Un=ht.initialize,Tn=ht.errors,Rn=ht.messages;function me(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(c){return Object.getOwnPropertyDescriptor(t,c).enumerable})),i.push.apply(i,r)}return i}function Ht(t){for(var e=1;e<arguments.length;e++){var i=arguments[e]!=null?arguments[e]:{};e%2?me(Object(i),!0).forEach(function(r){An(t,r,i[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):me(Object(i)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(i,r))})}return t}function An(t,e,i){return(e=function(r){var c=function(n,o){if(typeof n!="object"||n===null)return n;var a=n[Symbol.toPrimitive];if(a!==void 0){var s=a.call(n,o||"default");if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(o==="string"?String:Number)(n)}(r,"string");return typeof c=="symbol"?c:String(c)}(e))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var jn=ht.commonBasicLogger,Nn=function(t){return jn(Ht({destination:console.log},t))},he={promise:Promise.resolve({status:200,header:function(){return null},body:null})};function Fn(t,e,i,r,c){if(c&&!function(){var u=window.navigator&&window.navigator.userAgent;if(u){var l=u.match(/Chrom(e|ium)\/([0-9]+)\./);if(l)return parseInt(l[2],10)<73}return!0}())return he;var n=new window.XMLHttpRequest;for(var o in n.open(t,e,!c),i||{})Object.prototype.hasOwnProperty.call(i,o)&&n.setRequestHeader(o,i[o]);if(c)return n.send(r),he;var a,s=new Promise(function(u,l){n.addEventListener("load",function(){a||u({status:n.status,header:function(d){return n.getResponseHeader(d)},body:n.responseText})}),n.addEventListener("error",function(){a||l(new Error)}),n.send(r)});return{promise:s,cancel:function(){a=!0,n.abort()}}}var Vt=t=>{if(typeof t!="string")throw new TypeError("Expected a string");return t.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")};function $n(t,e,i,r){var c,n,o=((t.kind==="substring"||t.kind==="regex")&&r.includes("/")?e:e.replace(r,"")).replace(i,"");switch(t.kind){case"exact":n=e,c=new RegExp("^"+Vt(t.url)+"/?$");break;case"canonical":n=o,c=new RegExp("^"+Vt(t.url)+"/?$");break;case"substring":n=o,c=new RegExp(".*"+Vt(t.substring)+".*$");break;case"regex":n=o,c=new RegExp(t.pattern);break;default:return!1}return c.test(n)}function ye(t,e){for(var i={},r=null,c=[],n=0;n<t.length;n++)for(var o=t[n],a=o.urls||[],s=0;s<a.length;s++)if($n(a[s],window.location.href,window.location.search,window.location.hash)){o.kind==="pageview"?e("pageview",o):(c.push(o),e("click_pageview",o));break}return c.length>0&&(r=function(u){for(var l=function(g,m){for(var h=[],b=0;b<m.length;b++)for(var P=g.target,y=m[b],w=y.selector,O=document.querySelectorAll(w);P&&O.length>0;){for(var T=0;T<O.length;T++)P===O[T]&&h.push(y);P=P.parentNode}return h}(u,c),d=0;d<l.length;d++)e("click",l[d])},document.addEventListener("click",r)),i.dispose=function(){document.removeEventListener("click",r)},i}var Vn=300;function Hn(t,e){var i,r;function c(){r&&r.dispose(),i&&i.length&&(r=ye(i,n))}function n(o,a){var s=t.ident.getContext(),u={kind:o,key:a.key,data:null,url:window.location.href,creationDate:new Date().getTime(),context:s};return o==="click"&&(u.selector=a.selector),t.enqueueEvent(u)}return t.requestor.fetchJSON("/sdk/goals/"+t.getEnvironmentId()).then(function(o){o&&o.length>0&&(r=ye(i=o,n),function(a,s){var u,l=window.location.href;function d(){(u=window.location.href)!==l&&(l=u,s())}(function g(m,h){m(),setTimeout(function(){g(m,h)},h)})(d,a),window.history&&window.history.pushState?window.addEventListener("popstate",d):window.addEventListener("hashchange",d)}(Vn,c)),e()}).catch(function(o){t.emitter.maybeReportError(new Tn.LDUnexpectedResponseError((o&&o.message,o.message))),e()}),{}}var ft="goalsReady",qn={fetchGoals:{default:!0},hash:{type:"string"},eventProcessor:{type:"object"},eventUrlTransformer:{type:"function"},disableSyncEventPost:{default:!1}};function Mn(t,e){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},r=function(l){var d,g={userAgentHeaderName:"X-LaunchDarkly-User-Agent",synchronousFlush:!1};if(window.XMLHttpRequest){var m=l&&l.disableSyncEventPost;g.httpRequest=function(y,w,O,T){var S=g.synchronousFlush&!m;return g.synchronousFlush=!1,Fn(y,w,O,T,S)}}g.httpAllowsPost=function(){return d===void 0&&(d=!!window.XMLHttpRequest&&"withCredentials"in new window.XMLHttpRequest),d},g.httpFallbackPing=function(y){new window.Image().src=y};var h,b=l&&l.eventUrlTransformer;g.getCurrentUrl=function(){return b?b(window.location.href):window.location.href},g.isDoNotTrack=function(){var y;return(y=window.navigator&&window.navigator.doNotTrack!==void 0?window.navigator.doNotTrack:window.navigator&&window.navigator.msDoNotTrack!==void 0?window.navigator.msDoNotTrack:window.doNotTrack)===1||y===!0||y==="1"||y==="yes"};try{window.localStorage&&(g.localStorage={get:function(y){return new Promise(function(w){w(window.localStorage.getItem(y))})},set:function(y,w){return new Promise(function(O){window.localStorage.setItem(y,w),O()})},clear:function(y){return new Promise(function(w){window.localStorage.removeItem(y),w()})}})}catch{g.localStorage=null}if(l&&l.useReport&&typeof window.EventSourcePolyfill=="function"&&window.EventSourcePolyfill.supportedOptions&&window.EventSourcePolyfill.supportedOptions.method?(g.eventSourceAllowsReport=!0,h=window.EventSourcePolyfill):(g.eventSourceAllowsReport=!1,h=window.EventSource),window.EventSource){var P=3e5;g.eventSourceFactory=function(y,w){var O=Ht(Ht({},{heartbeatTimeout:P,silentTimeout:P,skipDefaultHeaders:!0}),w);return new h(y,O)},g.eventSourceIsActive=function(y){return y.readyState===window.EventSource.OPEN||y.readyState===window.EventSource.CONNECTING}}return g.userAgent="JSClient",g.version="3.1.3",g.diagnosticSdkData={name:"js-client-sdk",version:"3.1.3"},g.diagnosticPlatformData={name:"JS"},g.diagnosticUseCombinedEvent=!0,g}(i),c=Un(t,e,i,r,qn),n=c.client,o=c.options,a=c.emitter,s=new Promise(function(l){var d=a.on(ft,function(){a.off(ft,d),l()})});n.waitUntilGoalsReady=function(){return s},o.fetchGoals?Hn(c,function(){return a.emit(ft)}):a.emit(ft),document.readyState!=="complete"?window.addEventListener("load",c.start):c.start();var u=function(){r.synchronousFlush=!0,n.flush().catch(function(){}),r.synchronousFlush=!1};return document.addEventListener("visibilitychange",function(){document.visibilityState==="hidden"&&u()}),window.addEventListener("pagehide",u),n}var zn=Nn,Jn=void 0,Kn="3.1.3",Bn={initialize:function(t,e){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return console&&console.warn&&console.warn(Rn.deprecated("default export","named LDClient export")),Mn(t,e,i)},version:Kn};export{zn as basicLogger,Jn as createConsoleLogger,Bn as default,Mn as initialize,Kn as version};
