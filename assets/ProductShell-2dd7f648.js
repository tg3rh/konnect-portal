import{d as O,i as p,q as T,l as g,t as x,u as C,m as se,a as P,w as A,o as q,f as h,F as G,z as ae,j as b,k as V,v as D,A as U,s as M,n as W,S as re,U as ce,y as v,B as ie,af as le,c as Q,Q as ue}from"./vue-62e5e94d.js";import{_ as N,u as R,b as B,s as E,p as de,a as pe,d as ve,c as me}from"./index-c37d0faa.js";import{g as _e}from"./getMessageFromError-0a4f3a23.js";import{h as fe}from"./document-83d6e226.js";import{q as ge}from"./specRenderer-244ec543.js";import{f as Se}from"./fetchAll-2f0ffb50.js";import"./kongponents-0cdf713a.js";const he={key:0,class:"mb-3"},ye=O({__name:"Section",props:{title:{type:String,default:null}},setup(e){return(d,c)=>(p(),T("section",null,[e.title?(p(),T("header",he,[g("h2",null,x(e.title),1)])):C("",!0),se(d.$slots,"default",{},void 0,!0)]))}});const H=N(ye,[["__scopeId","data-v-13bc53f2"]]),Ie=O({name:"DocumentTree",props:{documents:{type:Array,required:!0},productId:{type:String,required:!0},activeDocumentId:{type:String,default:null},level:{type:Number,default:1},parentDocumentSlug:{type:String,default:""}},setup:e=>{const d=P({});function c(o,a){const i=a.reduce((l,u)=>(l[u.id]=!0,l),{});if(o){d.value=i;const l=a.find(u=>u.id===o||fe(u.children||[],o));l&&(i[l.id]=!1)}d.value=i}return A([()=>e.activeDocumentId,()=>e.documents],([o,a])=>{c(o,a)}),q(()=>{c(e.activeDocumentId,e.documents)}),{isNodeCollapsedMap:d}}});const be=e=>(re("data-v-71b5b1f1"),e=e(),ce(),e),De=be(()=>g("div",null,null,-1)),we={class:"expandable-node-container"},Ve=["onClick"],Te={class:"children",role:"region",tabindex:"-1"};function Ae(e,d,c,o,a,i){const l=h("router-link"),u=h("KIcon"),m=h("DocumentTree",!0),S=h("KCollapse");return p(),T("ul",null,[(p(!0),T(G,null,ae(e.documents,t=>(p(),T("li",{key:t.id},[t.children&&t.children.length?(p(),b(S,{key:0,modelValue:e.isNodeCollapsedMap[t.id],"onUpdate:modelValue":s=>e.isNodeCollapsedMap[t.id]=s,class:"collapse-container"},{trigger:V(()=>[De]),"visible-content":V(()=>[g("div",we,[D(l,{to:{name:"api-documentation-page",params:{product:e.productId,slug:[e.parentDocumentSlug,t.slug].filter(Boolean)}},style:U({paddingLeft:`${e.level-1}rem`}),class:M({title:!0})},{default:V(()=>[W(x(t.title),1)]),_:2},1032,["to","style"]),g("button",{class:M(["expand-button",e.isNodeCollapsedMap[t.id]?null:"expand-icon"]),onClick:s=>e.isNodeCollapsedMap[t.id]=!e.isNodeCollapsedMap[t.id]},[D(u,{icon:"chevronDown",size:"16"})],10,Ve)])]),default:V(()=>[g("div",null,[g("div",Te,[D(m,{documents:t.children,"active-document-id":e.activeDocumentId,"product-id":e.productId,level:e.level+1,"parent-document-slug":t.slug},null,8,["documents","active-document-id","product-id","level","parent-document-slug"])])])]),_:2},1032,["modelValue","onUpdate:modelValue"])):(p(),b(l,{key:1,to:{name:"api-documentation-page",params:{product:e.productId,slug:[e.parentDocumentSlug,t.slug].filter(Boolean)}},class:M({title:!0}),style:U({paddingLeft:`${e.level-1}rem`})},{default:V(()=>[W(x(t.title),1)]),_:2},1032,["to","style"]))]))),128))])}const Pe=N(Ie,[["render",Ae],["__scopeId","data-v-71b5b1f1"]]),$e=O({__name:"SectionOverview",props:{product:{type:Object,required:!0}},setup(e){const d=e,c=R().state.helpText.sectionOverview,o=B(),{documentTree:a,activeDocumentId:i}=E(o);return(l,u)=>v(a).length&&d.product?(p(),b(H,{key:0,title:v(c).title},{default:V(()=>[D(Pe,{documents:v(a),"product-id":d.product.id,"active-document-id":v(i)},null,8,["documents","product-id","active-document-id"])]),_:1},8,["title"])):C("",!0)}}),ke=O({__name:"SectionReference",props:{product:{type:Object,required:!0},activeProductVersionId:{type:String,required:!0},deselectOperation:{type:Boolean,default:!1}},emits:["operationSelected"],setup(e,{emit:d}){const c=e,o=P(null),a=P(!0),i=B();async function l(){var S,t;const u=(S=c.product)==null?void 0:S.id,m=c.activeProductVersionId;if(!(!u||!m)){a.value=!0;try{const s=await de.service.versionsApi.getProductVersionSpecOperations({productId:u,versionId:m});o.value=(t=s.data.operations)==null?void 0:t.map(_=>({..._,operationId:_.operation_id})),i.setSidebarOperations(o.value)}catch(s){console.error(s)}finally{a.value=!1}}}return l(),A([()=>c.product,()=>c.activeProductVersionId],l),(u,m)=>{const S=h("KSkeleton");return e.product&&e.product.versions.length?(p(),b(H,{key:0},{default:V(()=>[a.value?(p(),b(S,{key:0})):o.value?(p(),b(v(ge),{key:1,operations:o.value,deselect:e.deselectOperation,width:"100%",class:"operations-list",onSelected:m[0]||(m[0]=t=>d("operationSelected",t))},null,8,["operations","deselect"])):C("",!0)]),_:1})):C("",!0)}}});const Ce=N(ke,[["__scopeId","data-v-4998f0fe"]]),Oe={class:"px-5 py-6 content"},Ke={class:"mb-6"},xe={class:"title mb-5"},Ne=O({__name:"Sidebar",props:{deselectOperation:{type:Boolean,default:!1}},emits:["operationSelected"],setup(e,{emit:d}){const c=B(),{product:o,activeProductVersionId:a}=E(c),i=R().state.helpText.sidebar,l=i.noResultsProduct,u=P([]);function m(){var t;u.value=((t=o.value)==null?void 0:t.versions.slice().sort((s,_)=>new Date(s.created_at).getTime()-new Date(_.created_at).getTime()).map(s=>({value:s.id,label:`${s.name}${s.deprecated?i.deprecated:""}`,selected:s.id===a.value})))||[]}function S(t){var _;const s=(_=o.value)==null?void 0:_.versions.find($=>$.id===t.value);s&&c.setActiveProductVersionId(s.id)}return q(()=>{m()}),A([()=>o.value,()=>a.value],()=>{m()}),(t,s)=>{var y;const _=h("KAlert"),$=h("KSelect");return p(),T("aside",null,[g("div",Oe,[g("header",Ke,[g("span",xe,x((y=v(o))==null?void 0:y.name),1),v(o)&&!u.value.length?(p(),b(_,{key:0,appearance:"warning","alert-message":v(i).noVersions,class:"mb-4"},null,8,["alert-message"])):C("",!0),D($,{appearance:"select",class:"version-select-dropdown",width:"100%","data-testid":"version-select-dropdown","enable-filtering":!1,items:u.value,onChange:S},{empty:V(()=>[g("div",null,x(v(l)),1)]),_:1},8,["items"])]),D($e,{product:v(o)},null,8,["product"]),D(Ce,{"active-product-version-id":v(a),product:v(o),"deselect-operation":e.deselectOperation,onOperationSelected:s[0]||(s[0]=w=>d("operationSelected",w))},null,8,["active-product-version-id","product","deselect-operation"])])])}}});const Be=N(Ne,[["__scopeId","data-v-74fe2367"]]);function Me(e,d="asc"){return(c,o)=>{const a=new Date(c[e]).getTime(),i=new Date(o[e]).getTime();return a===i?0:d==="asc"?a>i?1:-1:a<i?1:-1}}const qe={class:"container flex pb-0 product fixed-position"},Re={class:"sidebar-wrapper"},Ee={class:"content"},Le=O({__name:"ProductShell",setup(e){const{notify:d}=me(),c=R().state.helpText,o=ie(),a=le(),{portalApiV2:i}=pe(),l=P(null),u=P(!1),m=P(!1),S=c.productVersion.deprecatedWarningProduct,t=B(),{product:s,documentTree:_,activeDocumentSlug:$,activeProductVersionId:y}=E(t),w=Q(()=>o.params.product),K=Q(()=>o.params.product_version);function L(){const n=o.params.slug,r=Array.isArray(n)?n[n.length-1]:n;r!==$.value&&t.setActiveDocumentSlug(r)}const{productsApi:J,versionsApi:X,documentationApi:Y}=i.value.service;async function Z(){const n=w.value;try{const{data:r}=await J.getProduct({productId:n}),f={...r,versions:await Se(I=>X.listProductVersions({...I,productId:n}))};t.setProduct(f)}catch(r){console.error(r),l.value=_e(r)}}async function ee(){const n=w.value;try{const r={productId:n,accept:ve.DocumentContentTypeEnum.VndKonnectDocumentTreejson},f=await Y.listProductDocuments(r);t.setDocumentTree(f.data.data)}catch(r){r.response.status===404?t.setDocumentTree([]):(console.error(r),d({appearance:"danger",message:c.productVersion.unableToRetrieveDoc}))}}function z(){var f,I;if(!s.value)return;const n=s.value.versions.slice().sort(Me("created_at"));if(!n)return;const r=(f=K.value)==null?void 0:f.toLowerCase();if(r){const k=n.find(j=>{var F;return j.id===r||((F=j.name)==null?void 0:F.toLowerCase())===r});k&&t.setActiveProductVersionId(k.id)}y.value||t.setActiveProductVersionId((I=n[0])==null?void 0:I.id)}function te(n){n&&a.replace({name:"api-documentation-page",params:{product:o.params.product,slug:[n]}})}function oe(){o.name==="spec"&&(t.setSidebarActiveOperation(null),a.push({name:"spec",params:{product:w.value,product_version:y.value}}))}function ne(n){const r={name:"spec",params:{product:w.value,product_version:y.value}};o.name!=="spec"?a.push(r).then(()=>t.setSidebarActiveOperation(n)):a.replace(r).then(()=>t.setSidebarActiveOperation(n))}return q(async()=>{L(),await Z(),await ee(),z()}),A(()=>K.value,()=>{K.value&&K.value!==y.value&&t.setActiveProductVersionId(K.value),z()}),A(()=>o.name,()=>{m.value=o.name!=="spec"}),A(()=>y.value,(n,r)=>{var I;if(r&&n!==r&&oe(),!((I=s.value)!=null&&I.version_count))return;const f=s.value.versions.filter(k=>k.id===y.value)[0];u.value=f==null?void 0:f.deprecated}),A(()=>w.value,()=>{var n;w.value!==((n=s.value)==null?void 0:n.id)&&t.setProduct(null)}),ue(()=>{var n;if(L(),_.value&&!$.value&&o.path.includes("/docs/")){const r=(n=_.value[0])==null?void 0:n.slug;te(r)}}),(n,r)=>{const f=h("EmptyState"),I=h("KAlert"),k=h("router-view");return p(),T("div",qe,[l.value?(p(),b(f,{key:0,"is-error":"",class:"mt-6",message:l.value},null,8,["message"])):(p(),T(G,{key:1},[g("div",Re,[D(Be,{class:"sidebar","deselect-operation":m.value,onOperationSelected:ne},null,8,["deselect-operation"])]),g("div",Ee,[u.value?(p(),b(I,{key:0,appearance:"warning","alert-message":v(S),class:"deprecated-warning"},null,8,["alert-message"])):C("",!0),D(k,{product:v(s)},null,8,["product"])])],64))])}}});const He=N(Le,[["__scopeId","data-v-b267a02a"]]);export{He as default};
